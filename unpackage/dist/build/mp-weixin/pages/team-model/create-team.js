(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/team-model/create-team"],{"13fc":function(e,t,o){"use strict";(function(e){function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){o.e("components/alert-menu/alert-menu").then(function(){return resolve(o("5c89"))}.bind(null,o)).catch(o.oe)},r={components:{AlertMenu:n},data:function(){return{menuList:[{name:"修改团队名称",id:"xgtdmc"},{name:"设置权限",id:"szqx"},{name:"设置备注",id:"szbz"},{name:"移除团队",id:"yctd"}],createTeamList:[{icon:"/static/img/QRCode.png",name:"团队二维码",path:"",pageId:"tdewm"},{icon:"/static/img/invite.png",name:"邀请好友加入",path:"",pageId:"yqhyjr"},{icon:"/static/img/set.png",name:"设置",path:"",pageId:"tdsz"}],memberList:[],teamInfo:{},operate:"",memberName:"",memberStatus:3,selectItem:{},currentState:null,accountId:"",myTeamInfo:{},teamName:"",hasShare:!1,hasAudit:!0,ewmUrl:"",shareId:"",pageId:"",oldTeam:{},search_val:""}},onLoad:function(t){var o,a=this,n=a.$getStorageSync("userData");if("undefined"==typeof n)return e.showModal({title:"提示",content:"请先登录授权~",success:function(t){t.confirm?e.switchTab({url:"/pages/tabbar/my/index?pageId=send"}):t.cancel&&e.switchTab({url:"/pages/tabbar/home/index?pageId=send"})}}),!1;if(t.q){var r=decodeURIComponent(t.q);console.log("ewmDataStrD",r);var s=r.indexOf("scanGroup/");r=r.substring(s+10,r.length),a.shareId=r,a.pageId="fxtd",a.getWxGroupByIdOrName(a.shareId)}try{o=JSON.parse(t.data)}catch(p){console.log(p)}a.accountId=a.$getStorageSync("token"),a.getWxGroupByOpenId(),a.shareId=o.teamCode,a.pageId=t.pageId,"fxtd"!=t.pageId?(a.getWxGroupList(o.groupId),a.getWxGroupByIdOrName(o.groupId)):a.getWxGroupByIdOrName(a.shareId),e.hideShareMenu()},onShow:function(){},onShareAppMessage:function(e){var t=this,o={teamCode:t.teamInfo.groupId};return{title:"邀请你加入"+t.teamInfo.groupName+"团队",path:"pages/team-model/create-team?pageId=fxtd&data="+JSON.stringify(o)}},methods:{getWxGroupByOpenId:function(){var t=this;t.$api.getWxGroupByOpenId().then((function(o){console.log(o),200==o.code&&(null!=o.data?"fxtd"==t.pageId?0!=o.data.status?(e.showToast({icon:"none",duration:1500,title:"您已加入团队："+o.data.groupName}),setTimeout((function(){e.switchTab({url:"/pages/tabbar/home/index"})}),1500)):(t.oldTeam=o.data,t.operate="ghtd",t.$refs["showpopup"].open()):t.myTeamInfo=o.data:"fxtd"==t.pageId&&(t.operate="fxtd",t.$refs["showpopup"].open()))}))},search_Member:function(){var e=this;e.getWxGroupList(e.teamInfo.groupId,e.search_val)},setUseMail:function(){var e=this;e.hasShare=!e.hasShare},setAudit:function(){var e=this;e.hasAudit=!e.hasAudit},addTeam:function(){var e,t=this,o=t.$getStorageSync("token");try{e=JSON.parse(t.$getStorageSync("userData"))}catch(n){console.log(n)}console.log("teamInfo",t.teamInfo);var a={groupId:t.teamInfo.groupId,groupName:t.teamInfo.groupName,openId:o,phone:e.phone,nickName:e.nickName,headimgurl:e.headimgurl,status:1,blShare:0,blAudit:1,createDate:"",updateDate:"",siteCode:t.teamInfo.siteCode,siteName:t.teamInfo.siteName,customerCode:"",customerName:""};t.$api.addWxGroup(a).then((function(e){console.log(e),200==e.code&&(t.getWxGroupList(t.teamInfo.groupId),t.$refs["showpopup"].close())}))},selectCancel:function(){var t=this;if(t.teamName="",t.memberName="","fxtd"==t.pageId)e.switchTab({url:"/pages/tabbar/home/index"}),t.$refs["showpopup"].close();else if("sh"==t.operate){var o={openId:t.selectItem.openId,groupId:t.teamInfo.groupId};t.$api.turnDownWxGroup(o).then((function(o){200==o.code&&(e.showToast({icon:"none",duration:1500,title:"拒绝成功~"}),t.getWxGroupList(t.teamInfo.groupId),t.memberName="",t.$refs["showpopup"].close())}))}else t.$refs["showpopup"].close()},selectRadio:function(e){var t=this;t.memberStatus=e},moreMenu:function(e,t){var o=this;"setMore"==t?o.menuList=[{name:"设置备注",id:"szbz"},{name:"设置权限",id:"szqx"},{name:"移除团队",id:"yctd"}]:"setMyself"==t&&(o.menuList=[{name:"设置备注",id:"szbz"}]),o.$refs["showpopup1"].open(),o.selectItem=e},cancelMenu:function(){var e=this;e.$refs["showpopup1"].close()},selectConfirm:function(){var t=this;if("szbz"==t.operate){var o={openId:t.selectItem.openId,nickName:t.memberName,groupId:t.teamInfo.groupId};t.$api.updateNickName(o).then((function(e){200==e.code&&(t.getWxGroupList(t.teamInfo.groupId),t.memberName="",t.$refs["showpopup"].close())}))}else if("szqx"==t.operate){var n={openId:t.selectItem.openId,status:t.memberStatus,groupId:t.teamInfo.groupId};t.$api.updateSatus(n).then((function(e){200==e.code&&(t.getWxGroupList(t.teamInfo.groupId),t.$refs["showpopup"].close())}))}else if("yctd"==t.operate){var r={openId:t.selectItem.openId,groupId:t.teamInfo.groupId};t.$api.deleteWxGroup(r).then((function(o){200==o.code?(t.getWxGroupList(t.teamInfo.groupId),t.$refs["showpopup"].close()):e.showToast({icon:"none",duration:1500,title:"移除团队失败~"})}))}else if("sh"==t.operate){var s={openId:t.selectItem.openId,groupId:t.teamInfo.groupId};t.$api.auditWxGroup(s).then((function(o){if(200==o.code)if(""!=t.memberName){var a={openId:t.selectItem.openId,nickName:t.memberName,groupId:t.teamInfo.groupId};t.$api.updateNickName(a).then((function(e){200==e.code&&(t.getWxGroupList(t.teamInfo.groupId),t.memberName="",t.$refs["showpopup"].close())}))}else t.getWxGroupList(t.teamInfo.groupId),t.memberName="",t.$refs["showpopup"].close();else e.showToast({icon:"none",duration:1500,title:"审核失败，请重试~"})}))}else if("jstd"==t.operate)if(t.myTeamInfo.groupName==t.teamName){var p={groupId:t.myTeamInfo.groupId};t.$api.emptyWxGroup(p).then((function(o){200==o.code?(t.$removeStorageSync("teamInfo"),t.$setStorageSync("teamModel","2"),e.switchTab({url:"/pages/tabbar/home/index"})):e.showToast({icon:"none",duration:1500,title:"解散团队失败~"})}))}else e.showToast({icon:"none",duration:1500,title:"团队名称不一致~"});else if("xgtdmc"==t.operate){var u=a({groupId:t.selectItem.groupId,groupName:t.teamName},"groupId",t.teamInfo.groupId);t.$api.editGroupName(u).then((function(o){200==o.code?(t.getWxGroupList(t.teamInfo.groupId),t.getWxGroupByIdOrName(u.groupId),t.teamName="",t.$refs["showpopup"].close()):e.showToast({icon:"none",duration:1500,title:"修改团队名称失败~"})}))}else if("szgxdzmd"==t.operate){var d={groupId:t.selectItem.groupId,blShare:t.hasShare?1:0};t.$api.editGroupBlShare(d).then((function(o){200==o.code?(t.getWxGroupList(t.teamInfo.groupId),t.$refs["showpopup"].close()):e.showToast({icon:"none",duration:1500,title:"面单共享失败~"})}))}else if("sfxyrtsp"==t.operate){var i={groupId:t.selectItem.groupId,blAudit:t.hasAudit?1:0};t.$api.editGroupBlAudit(i).then((function(o){200==o.code?(t.getWxGroupList(t.teamInfo.groupId),t.$refs["showpopup"].close()):e.showToast({icon:"none",duration:1500,title:"入团审批开关失败~"})}))}else if("tctd"==t.operate){var c={openId:t.selectItem.openId,groupId:t.teamInfo.groupId};t.$api.deleteWxGroup(c).then((function(o){200==o.code?(t.$refs["showpopup"].close(),t.$removeStorageSync("teamInfo"),t.$setStorageSync("teamModel","2"),e.switchTab({url:"/pages/tabbar/home/index"})):e.showToast({icon:"none",duration:1500,title:"退出团队失败~"})}))}else if("fxtd"==t.operate)t.addTeam();else if("ghtd"==t.operate){var m={openId:t.oldTeam.openId,groupId:t.oldTeam.groupId};t.$api.deleteWxGroup(m).then((function(o){200==o.code?t.addTeam():e.showToast({icon:"none",duration:1500,title:"更换团队失败~"})}))}},auditMember:function(e){var t=this;console.log(e),t.operate="sh",t.$refs["showpopup"].open(),t.selectItem=e},selectOperat:function(e){var t=this;switch(e.item.id){case"szbz":t.operate="szbz",t.$refs["showpopup"].open(),t.memberName=t.selectItem.nickName;break;case"szqx":t.operate="szqx",t.$refs["showpopup"].open(),t.memberStatus=t.selectItem.status;break;case"yctd":t.operate="yctd",t.$refs["showpopup"].open();break;case"jstd":t.operate="jstd",t.$refs["showpopup"].open();break;case"tctd":t.operate="tctd",t.$refs["showpopup"].open();break;case"xgtdmc":t.operate="xgtdmc",t.$refs["showpopup"].open(),t.teamName=t.selectItem.groupName;break;case"szgxdzmd":t.operate="szgxdzmd",t.$refs["showpopup"].open();break;case"sfxyrtsp":t.operate="sfxyrtsp",t.$refs["showpopup"].open();break;default:}t.$refs["showpopup1"].close()},getWxGroupList:function(e,t){var o,a=this;o=t?{groupId:e,nickName:t||null}:{groupId:e},a.$api.getWxGroupList(o).then((function(e){200==e.code&&e.data.length>0&&(a.memberList=e.data.map((function(e){return 3==e.status&&(e.sort=1),0==e.status&&(e.sort=2),e.openId==a.accountId&&(e.sort=3),2==e.status&&(e.sort=4),1==e.status&&(e.sort=5),e})).sort((function(e,t){return t.sort-e.sort})),console.log(a.memberList))}))},getWxGroupByIdOrName:function(t){var o=this,a={groupId:t};o.$api.getWxGroupByIdOrName(a).then((function(t){200==t.code&&null!=t.data?(o.teamInfo=t.data,o.hasShare=0!=t.data.blShare,o.hasAudit=1==t.data.blAudit):e.showToast({icon:"none",duration:1500,title:"未搜索到团队~"})}))},createPath:function(e){var t=this;if("tdewm"==e.pageId){t.$refs["showpopup2"].open();var o={groupId:t.teamInfo.groupId};t.$api.generateGroupQrCode(o).then((function(e){200==e.code&&(t.ewmUrl=e.data)}))}else"yqhyjr"==e.pageId||(1==t.myTeamInfo.status?t.menuList=[{name:"设置共享电子面单",id:"szgxdzmd"},{name:"解散团队",id:"jstd"},{name:"修改团队名称",id:"xgtdmc"},{name:"设置是否需要入团审批",id:"sfxyrtsp"}]:t.menuList=[{name:"退出团队",id:"tctd"}],t.$refs["showpopup1"].open(),t.selectItem=t.myTeamInfo)}}};t.default=r}).call(this,o("543d")["default"])},"291c":function(e,t,o){"use strict";o.d(t,"b",(function(){return n})),o.d(t,"c",(function(){return r})),o.d(t,"a",(function(){return a}));var a={uniPopup:function(){return o.e("components/uni-popup/uni-popup").then(o.bind(null,"e88b"))}},n=function(){var e=this,t=e.$createElement;e._self._c},r=[]},"8ce2":function(e,t,o){"use strict";o.r(t);var a=o("291c"),n=o("d55a");for(var r in n)"default"!==r&&function(e){o.d(t,e,(function(){return n[e]}))}(r);o("9eff");var s,p=o("f0c5"),u=Object(p["a"])(n["default"],a["b"],a["c"],!1,null,"efd2f98c",null,!1,a["a"],s);t["default"]=u.exports},"9eff":function(e,t,o){"use strict";var a=o("dc0a"),n=o.n(a);n.a},a66e:function(e,t,o){"use strict";(function(e){o("5e56");a(o("66fd"));var t=a(o("8ce2"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("543d")["createPage"])},d55a:function(e,t,o){"use strict";o.r(t);var a=o("13fc"),n=o.n(a);for(var r in a)"default"!==r&&function(e){o.d(t,e,(function(){return a[e]}))}(r);t["default"]=n.a},dc0a:function(e,t,o){}},[["a66e","common/runtime","common/vendor"]]]);