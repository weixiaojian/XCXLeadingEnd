(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/newaddress/index"],{"0c84":function(e,t,o){"use strict";(function(e){o("5e56");n(o("66fd"));var t=n(o("db16"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("543d")["createPage"])},"1db4":function(e,t,o){"use strict";o.d(t,"b",(function(){return i})),o.d(t,"c",(function(){return s})),o.d(t,"a",(function(){return n}));var n={uniPopup:function(){return o.e("components/uni-popup/uni-popup").then(o.bind(null,"e88b"))}},i=function(){var e=this,t=e.$createElement;e._self._c},s=[]},"63a4":function(e,t,o){"use strict";o.r(t);var n=o("77b9"),i=o.n(n);for(var s in n)"default"!==s&&function(e){o.d(t,e,(function(){return n[e]}))}(s);t["default"]=i.a},"751f":function(e,t,o){"use strict";var n=o("89e8"),i=o.n(n);i.a},"77b9":function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){o.e("components/mpvue-citypicker/mpvueCityPicker").then(function(){return resolve(o("d3da"))}.bind(null,o)).catch(o.oe)},i=function(){o.e("components/invinbg-image-cropper/invinbg-image-cropper").then(function(){return resolve(o("b9d3"))}.bind(null,o)).catch(o.oe)},s=requirePlugin("WechatSI"),a=s.getRecordRecognitionManager(),c="",r="",d={data:function(){return{title:"寄件人信息",name:"",phone:"",fj:"",cityPickerValueDefault:[0,0,0,0],provinces:"",provincesCode:"",address:"",address_details:"",custType:"",blDefault:!1,blOpen:!1,pageId:"",type:"",addressInfo:"",province_data:[],isEdit:!1,record:!1,recordState:"按住说话",recordTxt:!1,authTxt:"",isSetAuth:!1,tempFilePath:"",cropFilePath:"",imgCropper:!1,dotMove:!1,dottMove:!1}},onLoad:function(e){if(this.pageId=e.pageId,e.data){var t=JSON.parse(e.data);this.type=t.type,"send"==this.type&&(this.isEdit=t.isEdit),"send"!=this.type&&"bj"!=this.type&&"sends"!=this.type||this.echoData(t.item)}this.setHeadTitle(this.pageId)},components:{mpvueCityPicker:n,ImageCropper:i},methods:{showMulLinkageThreePicker:function(){this.$refs.mpvueCityPicker.show()},setHeadTitle:function(t){console.log(t),"jjr"==t?this.custType=0:"sjr"==t&&(this.custType=1),e.setNavigationBarTitle({title:"jjr"==t?"寄件人信息":"收件人信息"})},clearData:function(){var e=this;e.name="",e.phone="",e.fj="",e.cityPickerValueDefault=[0,0,0,0],e.provinces="",e.provincesCode="",e.address="",e.address_details=""},closeAlert:function(){var e=this;e.record=!1,e.isSetAuth=!1,e.$refs["showpopup"].close(),e.$refs["showpopup1"].close()},soundRecoring:function(){var e=this;this.$getAuth("scope.record").then((function(t){t?(e.clicktouse=!0,e.$refs["showpopup"].open()):(e.authTxt="麦克风",e.$refs["showpopup1"].open())}))},stopMaoPao:function(){},pressstart:function(){},shotPress:function(){e.showToast({title:"说话时间太短",mask:!0,icon:"none",duration:1500})},pressEnd:function(){var e=this;e.recordState="识别中...",clearInterval(r),clearTimeout(c),a.stop(),e.dotMove=!1,e.dottMove=!1,setTimeout((function(){e.recordState="按住说话",e.recordTips="依次说出姓名、电话、地址信息"}),1e3)},longPress:function(){var t=this;t.needHand=!0,t.recordState="请说话",t.dotMove=!0,t.dottMove=!0,console.log(t.dottMove),c=setTimeout((function(){t.needHand=!0,t.recordState=10,t.dotMove=!1,t.dottMove=!0,t.recordTips="剩余时间",r=setInterval((function(){t.recordState=t.recordState-1,0==t.recordState&&(clearInterval(r),clearTimeout(c),t.recordState="按住说话",t.recordTips="依次说出姓名、电话、地址信息",that.pressEnd())}),1e3)}),2e4),a.onStart=function(e){console.log("成功开始录音识别",e)},a.onRecognize=function(e){console.log("current result",e.result)},a.onStop=function(o){console.log(o),console.log("record file path",o.tempFilePath),t.recordState="识别中...",null==o.result||""==o.result||void 0==o.result?(e.showToast({title:"无法识别请重试",mask:!0,icon:"none",duration:1500}),t.recordState="按住说话",t.dotMove=!1,t.dottMove=!1):(t.recordState="按住说话",t.dotMove=!1,t.dottMove=!1,console.log("res.data",o.result),t.address_details=o.result,t.analysis())},a.onError=function(e){console.error("error msg",e.msg),t.recordState="按住说话"},a.start({duration:4e4,lang:"zh_CN"})},echoData:function(e){var t=this;this.addressInfo=e,this.name=e.name||"",this.phone=e.phone||"",this.fj=e.custPhone2||"",this.address=e.detailAddress||"",this.blDefault="1"==e.defaultValue,this.provinces=this.addressInfo.provice?"".concat(this.addressInfo.provice,"/").concat(this.addressInfo.city||"","/").concat(this.addressInfo.country||"","/").concat(this.addressInfo.townName||""):"请选择省市区",this.provincesCode=this.addressInfo.proviceId?"".concat(this.addressInfo.proviceId,"/").concat(this.addressInfo.cityId,"/").concat(this.addressInfo.countryId||"","/").concat(this.addressInfo.townId||""):"";var o=JSON.parse(this.$getStorageSync("province"));o&&o.forEach((function(e,o){e.province==t.addressInfo.provice&&(t.cityPickerValueDefault[0]=o),e.cityList&&e.cityList.forEach((function(e,o){e.cityName==t.addressInfo.city&&(t.cityPickerValueDefault[1]=o),e.countyList&&e.countyList.forEach((function(e,o){e.countyName==t.addressInfo.country&&(t.cityPickerValueDefault[2]=o)}))}))}))},cropperSure:function(t){var o=this;this.cropFilePath=t.detail.tempFilePath,console.log(this.cropFilePath);var n=e.getFileSystemManager();n.readFile({filePath:this.cropFilePath,encoding:"base64",success:function(e){var t=e.data;o.$api.imgAnalysis(t).then((function(e){console.log(e),200==e.code&&(o.address_details=e.data,o.analysis(),o.clearImgData())}))}})},clearImgData:function(){var e=this;e.tempFilePath="",e.cropFilePath="",e.imgCropper=!1},cancel:function(){var e=this;e.clearImgData()},choosImg:function(t){var o=this;e.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:function(e){o.tempFilePath=e.tempFilePaths[0],console.log(o.tempFilePath),o.imgCropper=!0},fail:function(){}})},blurInput:function(){var e=this;e.analysis()},analysis:function(){var t=this,o=this;if(""!=o.address_details){var n={address:o.$Reg.stripscript(o.$Reg.removeHTMLTag(o.address_details))};o.$api.addressAnalysis(n).then((function(t){if(200==t.code){o.name=t.data.name,o.phone=t.data.phone,o.address=t.data.formatAddress;var n={province:t.data.province||"",city:t.data.cityName||"",county:t.data.countyName||"",town:t.data.townName||""};return o.$api.checkProvince(n)}Promise.reject(),e.showToast({icon:"none",title:t.message,duration:2e3})})).then((function(o){if(200==o.code){var n=o.data.townName?"/"+o.data.townName:"",i=o.data.townCode?"/"+o.data.townCode:"";t.provinces=o.data.province+"/"+o.data.cityName+"/"+o.data.countyName+n,t.provincesCode=o.data.provinceCode+"/"+o.data.cityCode+"/"+o.data.countyCode+i}else 400==o.code&&e.showToast({icon:"none",title:o.message,duration:2e3})}))}else e.showToast({icon:"none",title:"请输入要识别信息"})},checkboxChange:function(e){var t=this,o=e.detail.value;o.length>0?o.forEach((function(e,n){t.blDefault=!!o.includes("mr")})):this.blDefault=!1},onConfirm:function(e){console.log(e),this.provinces=e.label.replace(/-/gi,"/"),this.provincesCode=e.code.replace(/-/gi,"/")},confirm:function(){if(""!=this.name)if(""!=this.phone)if(this.$Reg.RegTel(this.phone))if(""!=this.provinces&&"请选择省市区"!=this.provinces)if(""!=this.address){var t=this.provinces,o=this.provincesCode,n=(this.fj?this.fj+"-":"")+this.phone,i={defaultValue:this.blDefault?"1":"0",blOpen:this.blOpen?"1":"0",detailAddress:this.address,provice:t.split("/")[0],city:t.split("/")[1],country:t.split("/")[2]||"",townName:t.split("/")[3]||"",proviceId:o.split("/")[0],cityId:o.split("/")[1],countryId:o.split("/")[2]||"",townId:o.split("/")[3]||"",name:this.name,phone:n,blType:this.custType,guid:""};console.log(i),"tj"==this.type?this.$api.addAddress(i).then((function(t){if(200==t.code){e.showToast({icon:"none",title:"添加成功",duration:1500,mask:!0});var o=getCurrentPages(),n=o[o.length-2];n.$vm.guidArry.push(t.data),setTimeout((function(){e.navigateBack({delta:1})}),1e3)}})):"bj"==this.type?(i.guid=this.addressInfo.guid,this.$api.editAddress(i).then((function(t){200==t.code&&(e.showToast({icon:"none",title:"修改成功",duration:1500,mask:!0}),setTimeout((function(){e.navigateBack({delta:1})}),1e3))}))):"send"!=this.type&&"sends"!=this.type||(null==this.addressInfo?i.guid="":i.guid=this.addressInfo.guid,this.isEdit?(setTimeout((function(){e.navigateBack({delta:1})}),1e3),console.log(i),e.$emit("inputAddress",i)):i.guid?this.$api.editAddress(i).then((function(t){200==t.code&&(e.showToast({icon:"none",title:"修改成功~",duration:1e3,mask:!0}),setTimeout((function(){e.navigateBack({delta:1})}),1e3),e.$emit("inputAddress",i))})):this.$api.addAddress(i).then((function(t){200==t.code&&(e.showToast({icon:"none",title:"添加成功~",duration:1e3,mask:!0}),setTimeout((function(){e.navigateBack({delta:1})}),1e3),e.$emit("inputAddress",i))})))}else e.showToast({icon:"none",title:"请输入详细地址"});else e.showToast({icon:"none",title:"请选择省市区"});else e.showToast({icon:"none",title:"电话输入有误"});else e.showToast({icon:"none",title:"请输入电话"});else e.showToast({icon:"none",title:"请输入姓名"})}}};t.default=d}).call(this,o("543d")["default"])},"89e8":function(e,t,o){},db16:function(e,t,o){"use strict";o.r(t);var n=o("1db4"),i=o("63a4");for(var s in i)"default"!==s&&function(e){o.d(t,e,(function(){return i[e]}))}(s);o("751f");var a,c=o("f0c5"),r=Object(c["a"])(i["default"],n["b"],n["c"],!1,null,"3bcdcf38",null,!1,n["a"],a);t["default"]=r.exports}},[["0c84","common/runtime","common/vendor"]]]);